################################
# モニタ設定
################################
# 1. 正面 (3840x2160)
monitor = DP-4, preferred, 0x0, auto

# 2. 右側 (2560x1440 / 縦置き)
# 4Kモニタの幅 3840 だけ右に配置
monitor = DP-5, preferred, 3840x0, auto, transform, 3

# 3. 一番右 (本体 3072x1920)
# 3840(DP-4) + 1440(DP-5の短辺) = 5280
monitor = eDP-1, preferred, 5280x0, auto


################################
# Fcitx5設定
################################
# Hyprland起動時にFcitx5が立ち上がるようにし、環境変数をセットします。

# 環境変数 (日本語入力用 - アプリ対応の追加)
# env = GTK_IM_MODULE, fcitx
# env = QT_IM_MODULE, fcitx
# env = XMODIFIERS, @im=fcitx
# env = SDL_IM_MODULE, fcitx

# 自動起動
# -d: デーモンモード, --replace: 二重起動防止
exec-once = fcitx5 -d --replace

# Bluetoothアプレット (GUI管理ツール)
# 右上のトレイアイコンから接続状況を確認・再接続しやすくなります
exec-once = blueman-applet


input {
    # マウスをMac風（ナチュラルスクロール）にする
    natural_scroll = true
    sensitivity = 0
    accel_profile = flat

    touchpad {
        # タッチパッドをMac風（ナチュラルスクロール）にする
        natural_scroll = true
        # これを false にすると、軽く触れるだけでは反応しなくなります
        tap-to-click = false
        # 二本指で右クリック
        clickfinger_behavior = true
    }
}

# マウス固有の設定 (上書き)
# name には hyprctl devices で取得した名前を指定
device {
    name = magic-mouse-white

    # 速度調整: -1.0 が最も遅くなります。
    # -0.8 でも速い場合は -0.9 や -1.0 を試してください。
    sensitivity = -0.6

    # Mac風のスクロール ("ナチュラルスクロール") を強制的に有効化
    natural_scroll = true

    scroll_factor = 4
}

# -----------------------------------------------------
# Modifier Definition
# -----------------------------------------------------

# メインモディファイアを "Ctrl + Shift + Alt" に変更
# これで物理的な CapsLock(長押し) が $mainMod になります
# $mainMod = CTRL SHIFT ALT

# -----------------------------------------------------
# Key Bindings
# -----------------------------------------------------

# これで「Caps + Enter」などの操作が、
# 内部的には「Ctrl+Shift+Alt+Enter」として処理されます。
# bind = $mainMod, RETURN, exec, uwsm-app -- xdg-terminal-exec --dir="$(omarchy-cmd-terminal-cwd)"
# bind = $mainMod, B, exec, omarchy-launch-browser
# bind = $mainMod, F, exec, uwsm-app -- nautilus --new-window
# bind = $mainMod, SPACE, exec, fuzzel
# bind = $mainMod, Q, killactive,

# ウィンドウ移動
# bind = $mainMod, h, movefocus, l
# bind = $mainMod, l, movefocus, r
# bind = $mainMod, k, movefocus, u  <-- 下のCheat Sheet設定と被るためコメントアウト推奨（必要なら戻してください）
# bind = $mainMod, j, movefocus, d

# =====================================================
# Fix: Cmd+K Problem
# =====================================================

# 1. 犯人を消す (Omarchyデフォルトの Cheat Sheet 起動を無効化)
# unbind = SUPER, k

# 2. Cmd+K (親指) を「アプリへの命令 (Ctrl+K)」に変える
# これで Slack のチャンネル移動やブラウザ検索ができるようになります
# bind = SUPER, k, sendshortcut, CTRL, k, activewindow

# 3. Cheat Sheet は Caps+K (小指) に移動させる
# ($mainMod は CTRL SHIFT ALT になっている前提です)
# bind = $mainMod, k, exec, omarchy-cheat-sheet

# ---------------------------------------------------------
# RoBa Auto-Connect Strategy
# ---------------------------------------------------------
# 1. Bluetooth電源を確実にON
# 2. ペアリング済みリストから "roBa" を含むデバイスのMACアドレスを動的取得
# 3. そのアドレスに対して接続コマンドを投げる
# ---------------------------------------------------------
exec-once = rfkill unblock bluetooth && bluetoothctl power on
exec-once = sleep 5 && bluetoothctl connect $(bluetoothctl devices | grep "roBa" | awk '{print $2}' | head -n 1)
